<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<!-- 原始用户角色切换功能（备份保留） -->
<div id="myrolechange_bk">
	<h1>当前角色：</h1>
	<div>
		<form id="defroleform" method="post" onsubmit="return defRoleChange('defroleform','defroleselector')">
			<select id="defroleselector">
				<option th:each="role:${session.userroles}" th:value="${role.id}" th:text="${role.name}"
					th:selected="${role.id} == ${session.defrole.id}"></option>
			</select>
			<button type="submit">切换角色</button>
		</form>
	</div>
	<br>
</div>


<!-- 原始系统菜单列表（备份保留） -->
<div id="mymenu_bk">
	<h1>用户菜单：</h1>
	<div>
		<ul>
			<li th:each="menu:${session.defrole.menuList}">
				<th:block th:if="${not #lists.isEmpty(menu.urlList)}">
					<div th:each="url:${menu.urlList}">
						<a th:if="${url.isEntrance}" th:href="@{${url.path}}"
							th:text="${menu.name}">[[${menu.name}]]</a>
					</div>
				</th:block>
				<th:block th:if="${#lists.isEmpty(menu.urlList)}">
					[[${menu.name}]]
				</th:block>
			</li>
		</ul>
	</div>
</div>


<!-- 顶部菜单组件 -->
<div id="mymenu">
	<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
		<div class="container">

			<div>
				<!-- 网站logo -->
				<img th:src="@{/pic/logo_32.png}" />
			</div>
			<!-- 网站名称 -->
			<div>
				<a class="navbar-brand disabled" th:href="@{index}">
					<strong>ePower System</strong>
				</a>
			</div>

			<div class="collapse navbar-collapse" id="navbarNavDropdown-1">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active"><a class="nav-link" th:href="@{/index}">首页<span
								class="sr-only">(current)</span></a></li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false">切换角色</a>
						<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
							<div th:each="role:${session.userroles}">
								<a class="dropdown-item" th:href="@{/rolechange(def=${role.id})}">[[${role.name}]]</a>
							</div>
						</div>
					</li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false">系统菜单</a>
						<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

							<!-- 开始显示菜单 -->
							<div th:each="menu:${session.defrole.menuList}">
								<!-- 如果菜单配置正确，正常显示 -->
								<th:block th:if="${not #lists.isEmpty(menu.urlList)}">
									<div th:each="url:${menu.urlList}">
										<a class="dropdown-item" th:if="${url.isEntrance}"
											th:href="@{${url.path}}">[[${menu.name}]]</a>
									</div>
								</th:block>
								<!-- 如果菜单配置不正确，只显示菜单名字，但无法进入页面 -->
								<th:block th:if="${#lists.isEmpty(menu.urlList)}">
									<a class="dropdown-item disabled" href="#">[[${menu.name}]]</a>
								</th:block>
							</div>
							<!-- 没有分配任何菜单，显示提示信息 -->
							<div th:if="${#lists.isEmpty(session.defrole.menuList)}">
								<div>
									<a class="dropdown-item disabled" href="#">暂无分配任何菜单</a>
								</div>
							</div>
						</div>
					</li>
				</ul>
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link disabled text-light btn-round" href="#">
							欢迎回来！[[${session.loginuser.username}]] ([[${session.defrole.name}]])
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link bg-danger btn-round" th:href="@{/logout}"><strong>退出登录</strong></a>
					</li>
				</ul>
			</div>
		</div>
	</nav>
</div>


<!-- 数据分页组件 -->
<div id="mypagination">
	<!-- pagination -->
	<nav aria-label="Page navigation example">
		<ul class="pagination">
			<!-- 上一页 -->
			<li class="page-item">
				<a class="page-link" th:href="@{list(pageNum=${pageinfo.prePage})}"><i
						class="fas fa-angle-left"></i></a>
			</li>

			<li class="page-item" th:each="currpage:${pageinfo.navigatepageNums}"
				th:classappend="${currpage eq pageinfo.pageNum} ? 'active'">
				<a class="page-link" th:href="@{list(pageNum=${currpage})}" th:text="${currpage}"></a>
			</li>
			<!-- 下一页 -->
			<li class="page-item">
				<a class="page-link" th:href="@{list(pageNum=${pageinfo.nextPage})}"><i
						class="fas fa-angle-right"></i></a>
			</li>
		</ul>
	</nav>
</div>


<!-- 底部Footer组件 -->
<div id="myfooter">
	<footer class="bg-primary pb-5 pt-4">
		<div class="container">
			<div class="row justify-content-center text-center">
				<div class="col-md-12">
					<span class="d-block mt-3 text-gray">
						<small class="d-block mt-3 mb-3 text-muted">© 2024 ePower System & Designed By Xiaodan
							SHAO.</small>
					</span>
				</div>
			</div>
		</div>
	</footer>
</div>


<!-- 页面头部公共资源组件 -->

<head th:fragment="myheader(title)">
	<meta charset="UTF-8">
	<title>[[${title}]]</title>

	<!-- 设置网站icon图标 -->
	<link rel="shortcut icon" th:href="@{/pic/favicon.ico}" />

	<!-- 第三方UI库 -->
	<link href="https://fonts.googleapis.com/css?family=Nunito:300,300i,400,600,800" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
		integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
	<link rel="stylesheet" th:href="@{/css/all.css}">
	<link rel="stylesheet" th:href="@{/css/main.css}">
	<link rel="stylesheet" th:href="@{/css/aos.css}">

	<!-- bootstrap公共JS库 -->
	<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>

	<!-- ePower的公共脚本 -->
	<script th:src="@{/js/epower.js}" type="text/javascript"></script>
</head>


<!-- 页面tool bar的工具组件(备份) -->
<div th:fragment="mytoolbar_bk(name)">
	<div align="center">
		<h1>[[${name}]]管理页面</h1>
	</div>
	<div align="left">
		<button type="button" class="btn btn-primary btn-icon-only" onclick="window.location.href='/index'">
			<span class="btn-inner--icon"><i class="fas fa-home"></i></span>
		</button>
		<button type="button" class="btn btn-primary" onclick="window.location.href='add'">添加[[${name}]]</button>
	</div>
</div>


<!-- 页面tool bar的工具组件 -->
<div th:fragment="mytoolbar(name, path)">
	<div align="center">
		<h1>[[${name}]]管理页面</h1>
	</div>
	<div align="left">
		<button type="button" class="btn btn-primary btn-icon-only" onclick="window.location.href='/index'">
			<span class="btn-inner--icon"><i class="fas fa-home"></i></span>
		</button>
		<span th:each="url:${verifyurls}">
			<span th:if="${url.path == path}">
				<button type="button" class="btn btn-primary"
					onclick="window.location.href='add'">添加[[${name}]]</button>
			</span>
		</span>
	</div>
</div>


</html>